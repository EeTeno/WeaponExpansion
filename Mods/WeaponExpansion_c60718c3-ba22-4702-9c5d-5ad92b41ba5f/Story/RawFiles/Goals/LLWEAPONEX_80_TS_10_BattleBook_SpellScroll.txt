Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
IF
CharacterStartAttackPosition(_x, _y, _z, _, _Char)
AND
IsTagged(_Char, "LLWEAPONEX_BattleBooks_SpellScrollEquipped", 1)
AND
HasActiveStatus(_Char, "LLWEAPONEX_BATTLEBOOK_SPELLSCROLL_HIT_READY", 1)
THEN
LLWEAPONEX_BattleBooks_SpellScroll_Fire(_Char, _x, _y, _z, 1000);

//Summon by SkilLProperties workaround
IF
CharacterStatusAttempt(_Char, "SUMMONING", _)
AND
IsTagged(_Char, "TOTEM", 1)
AND
CharacterGetOwner(_Char, _Owner)
AND
IsTagged(_Owner, "LLWEAPONEX_BattleBooks_SpellScrollEquipped", 1)
AND
GetVarFloat3(_Owner, "LLWEAPONEX_Battlebooks_SpellScroll_AttackPosition", _x, _y, _z)
THEN
TeleportToPosition(_Char, _x, _y, _z, "LLWEAPONEX_Battlebooks_SpellScroll_TotemTeleported", 0, 1);

IF
StoryEvent((CHARACTERGUID)_Totem, "LLWEAPONEX_Battlebooks_SpellScroll_TotemTeleported")
THEN
//Teleport one more time so it doesn't get stuck in something.
TeleportTo(_Totem, _Totem, "LLWEAPONEX_Battlebooks_SpellScroll_TotemTeleported_SnappedPosition_PlayEffect", 0, 1);

IF
StoryEvent((CHARACTERGUID)_Totem, "LLWEAPONEX_Battlebooks_SpellScroll_TotemTeleported_SnappedPosition_PlayEffect")
THEN
PlayEffect(_Totem, "RS3_FX_Skills_Totem_Target_Nebula_01", "Dummy_Root");
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LLWEAPONEX_80_ToggledScripts"