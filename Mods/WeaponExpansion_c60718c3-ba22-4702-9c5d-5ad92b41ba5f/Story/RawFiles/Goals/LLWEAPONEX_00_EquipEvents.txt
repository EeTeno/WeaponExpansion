Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
IF
ItemEquipped(_Item, _PLayer)
AND
DB_IsPlayer(_PLayer)
AND
NOT LeaderLib_Helper_QRY_IgnoreItem(_Item)
AND
NOT LeaderLib_Helper_QRY_IgnoreCharacter(_PLayer)
THEN
LLWEAPONEX_OnItemEquipped(_PLayer, _Item);

PROC
LLWEAPONEX_OnItemEquipped((CHARACTERGUID)_Player, (ITEMGUID)_Item)
AND
LLWEAPONEX_QRY_ItemIsWeapon(_Item)
THEN
LeaderLib_Tags_PreserveTag(_Player, "LLWEAPONEX_AnyWeaponEquipped");

IF
ItemUnEquipped(_Item, _Player)
AND
DB_IsPlayer(_PLayer)
AND
NOT LeaderLib_Helper_QRY_IgnoreItem(_Item)
AND
NOT LeaderLib_Helper_QRY_IgnoreCharacter(_PLayer)
THEN
LLWEAPONEX_OnItemUnEquipped(_PLayer, _Item);

PROC
LLWEAPONEX_OnItemUnEquipped((CHARACTERGUID)_Player, (ITEMGUID)_Item)
AND
LLWEAPONEX_QRY_ItemIsWeapon(_Item)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Player)
THEN
LeaderLib_Tags_ClearPreservedTag(_Player, "LLWEAPONEX_AnyWeaponEquipped");

//REGION PRESET_APPLIED
PROC
ProcObjectTimerFinished((CHARACTERGUID)_Player, "LeaderLib_Timers_PresetMenu_OnPresetApplied")
AND
NOT LeaderLib_Helper_QRY_IgnoreCharacter(_PLayer)
AND
DB_LeaderLib_EquipmentSlots(_Slot)
AND
CharacterGetEquippedItem(_Player, _Slot,  (ITEMGUID)_Item)
AND
_Item != NULL_00000000-0000-0000-0000-000000000000
AND
NOT LeaderLib_Helper_QRY_IgnoreItem(_Item)
THEN
LLWEAPONEX_OnItemEquipped(_Player, _Item);
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LLWEAPONEX_00_PostCC"