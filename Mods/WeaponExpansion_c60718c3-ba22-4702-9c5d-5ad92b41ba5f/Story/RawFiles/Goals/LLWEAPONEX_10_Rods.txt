Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION

//REGION SKILL_REFRESH
//Post LeaderLib Preset
PROC
ProcObjectTimerFinished((CHARACTERGUID)_Player, "LeaderLib_Timers_PresetMenu_OnPresetApplied")
AND
LLWEAPONEX_QRY_WeaponTypeEquipped(_Player, "LLWEAPONEX_Rod")
THEN
LeaderLog_Log("DEBUG", "[LLWEAPONEX:Rods] Refreshing rod weapon(s) to determine related skill.");
LeaderLib_Helper_RefreshWeapons(_Player);
//END_REGION

//REGION ADD_ROD_SKILL
PROC
LLWEAPONEX_Rods_AddRodSkill((CHARACTERGUID)_Char, (ITEMGUID)_Rod, "Weapon", (STRING)_MainHandSkill, (STRING)_OffhandSkill)
THEN
CharacterAddSkill(_Char, _MainHandSkill, 0);
CharacterRemoveSkill(_Char, _OffhandSkill);

PROC
LLWEAPONEX_Rods_AddRodSkill((CHARACTERGUID)_Char, (ITEMGUID)_Rod, "Shield", (STRING)_MainHandSkill, (STRING)_OffhandSkill)
AND
NOT LeaderLib_Helper_QRY_HasItemInSlot(_Char, "Weapon")
THEN
CharacterAddSkill(_Char, _MainHandSkill, 0);
CharacterRemoveSkill(_Char, _OffhandSkill);

PROC
LLWEAPONEX_Rods_AddRodSkill((CHARACTERGUID)_Char, (ITEMGUID)_Rod, "Shield", (STRING)_MainHandSkill, (STRING)_OffhandSkill)
AND
LeaderLib_Helper_QRY_HasItemInSlot(_Char, "Weapon")
THEN
CharacterAddSkill(_Char, _OffhandSkill, 0);
CharacterRemoveSkill(_Char, _MainHandSkill);

PROC
LLWEAPONEX_Equipment_OnTaggedItemEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, "LLWEAPONEX_Rod", (INTEGER)_IsPlayer)
AND
ItemGetEquipmentSlot(_Item, _Slot)
AND
LLWEAPONEX_Ext_QRY_GetRodSkills(_Item, _MainhandSkill, _OffhandSkill)
THEN
LLWEAPONEX_Rods_AddRodSkill(_Char, _Item, _Slot, _MainHandSkill, _OffhandSkill);
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LLWEAPONEX_00_PostCC"