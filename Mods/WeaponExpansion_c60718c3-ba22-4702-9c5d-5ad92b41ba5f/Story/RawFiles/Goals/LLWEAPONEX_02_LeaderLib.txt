Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
IF
StoryEvent(_, "LeaderLib_Initialized")
AND
NOT DB_LLWEAPONEX_RegisteredLeaderLibSettings(_)
THEN
DB_LLWEAPONEX_RegisteredLeaderLibSettings(1);

IF
DB_LLWEAPONEX_RegisteredLeaderLibSettings(1)
THEN
LeaderLib_Register_ModMenu("LaughingLeader.WeaponExpansion", "[Weapon Expansion] Settings", "LLWEAPONEX_SettingsMenu", "WeaponExpansion", "LaughingLeader");

LeaderLib_Trader_Register_Position("LeaderLib.LeaderTrader", "TestLevel_LL_WeaponExpansion", 12.0, 0.0, 8.0);
LeaderLib_Trader_Register_StartingGold("LeaderLib.LeaderTrader", "TestLevel_LL_WeaponExpansion", 9999);

LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_Assassin", "Assassin [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_Blademaster", "Blademaster [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_ChaosWeaver", "Chaos Weaver [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_DragonSlayer", "Dragon Slayer [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_DualShields", "Shieldmaster [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_Fencer", "Fencer [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_MonkWoodenQuarterstaff", "Monk (Wooden Quarterstaff) [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_MonkMetalQuarterstaff", "Monk (Metal Quarterstaff) [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_RunicKnight", "Runic Knight [Weapon Expansion]", "WeaponExpansion_IsActive");

//Deltamods
LeaderLib_Deltamods_Register_Group("WeaponExpansion.CombatShields", 0);
//LeaderLib_Deltamods_Register_Template("WeaponExpansion.CombatShields", "WPN_LLWEAPONEX_CombatShield_Blackring_A_ec353f1e-c1ca-46d1-83ef-e9f4fea14475", 0);
//LeaderLib_Deltamods_Register_Template("WeaponExpansion.CombatShields", "WPN_LLWEAPONEX_CombatShield_Lizards_C_067f48be-857d-43a8-bd0a-add59f025843", 0);

//Group, Rarity, Deltamod, Chance/999, MinLevel, MaxLevel
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "NonEpic", "Boost_LLWEAPONEX_Weapon_Primary_Constitution_CombatShield", 600, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Exceptional", "Boost_LLWEAPONEX_Weapon_Primary_Constitution_CombatShield_Medium", 600, 10);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Legendary", "Boost_LLWEAPONEX_Weapon_Primary_Constitution_CombatShield_Large", 600, 16);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Normal", "Boost_LLWEAPONEX_Weapon_Ability_OneHanded_CombatShield", 100, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Normal", "Boost_LLWEAPONEX_Weapon_Ability_Perserverance_CombatShield", 100, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Normal", "Boost_LLWEAPONEX_Weapon_Ability_PainReflection_CombatShield", 100, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Normal", "Boost_LLWEAPONEX_Weapon_Ability_WarriorLore_CombatShield", 100, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "NonEpic", "Boost_LLWEAPONEX_Weapon_Skill_CripplingBlow_CombatShield", 450, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "NonLegendary", "Boost_LLWEAPONEX_Weapon_Skill_GuardianAngel_CombatShield", 450, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Legendary", "Boost_LLWEAPONEX_Weapon_Skill_DeflectiveBarrier_CombatShield", 100, 10);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Legendary", "Boost_LLWEAPONEX_Weapon_Skill_ThickOfTheFight_CombatShield", 550, 1);

LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "NonEpic", "Boost_LLWEAPONEX_Weapon_Status_Set_Crippled_CombatShield_Rare", 100, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Exceptional", "Boost_LLWEAPONEX_Weapon_Status_Set_Crippled_CombatShield_Rare", 299, 1);
LeaderLib_Deltamods_Add_Chance("WeaponExpansion.CombatShields", "Legendary", "Boost_LLWEAPONEX_Weapon_Status_Set_Crippled_CombatShield_Rare", 499, 1);

LeaderLib_Deltamods_Register_MaxGuaranteedForGroup("WeaponExpansion.CombatShields", 2);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "NonEpic", "Boost_Weapon_Secondary_Vitality", 1);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "NonEpic", "Boost_Weapon_LifeSteal", 1);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "NonEpic", "Boost_Weapon_Ability_Telekinesis_Wand", 1);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "Exceptional", "Boost_Weapon_Secondary_Vitality_Normal", 1);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "Exceptional", "Boost_Weapon_Secondary_CriticalChance", 1);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "Exceptional", "Boost_Weapon_Ability_Necromancy_Wand", 1);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "Exceptional", "Boost_Weapon_Damage_ArmourPiercing", 1);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "Legendary", "Boost_Weapon_Secondary_CriticalModifier", 1);
LeaderLib_Deltamods_Add_List("WeaponExpansion.CombatShields", "Legendary", "Boost_Weapon_LifeSteal_Large", 1);

LeaderLib_Helper_Blacklist_TagFromCopying("LaughingLeader_WeaponExpansion", "LLWEAPONEX_Grimoire");
LeaderLib_Helper_Blacklist_TagFromCopying("LaughingLeader_WeaponExpansion", "LLWEAPONEX_CombatShield");

PROC
LeaderUpdater_ModUpdated("WeaponExpansion", "LaughingLeader", (STRING)_PastVersion, "0.9.0.9")
THEN
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_ChaosWeaver", "Chaos Weaver [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_DragonSlayer", "Dragon Slayer [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_MonkQuarterstaff", "Monk (Quarterstaff) [Weapon Expansion]", "WeaponExpansion_IsActive");
LeaderLib_PresetMenu_RegisterPreset("LLWEAPONEX_RunicKnight", "Runic Knight [Weapon Expansion]", "WeaponExpansion_IsActive");

/*
LeaderLib_Treasure_Register_TreasureToTrader("LLWEAPONEX.LeaderTrader.TestWeapons", "LeaderLib.LeaderTrader");
LeaderLib_Requirements_Add_RegionRequirement("LLWEAPONEX.Debug.IsTestLevel", "TestLevel_LL_WeaponExpansion");
LeaderLib_Treasure_Register_TreasureTable("LLWEAPONEX.LeaderTrader.TestWeapons", "LLWEAPONEX_Debug_PriceCheck", "LLWEAPONEX.Debug.IsTestLevel", 1);
LeaderLib_Treasure_Register_TreasureTable("LLWEAPONEX.LeaderTrader.TestWeapons", "LLWEAPONEX_CheatQuarterstaffs", "LLWEAPONEX.Debug.IsTestLevel", 1);
LeaderLib_Treasure_Register_TreasureTable("LLWEAPONEX.LeaderTrader.TestWeapons", "ST_Grenades", "LLWEAPONEX.Debug.IsTestLevel", 1);
LeaderLib_Treasure_Register_TreasureTable("LLWEAPONEX.LeaderTrader.TestWeapons", "ST_WeaponNormal", "LLWEAPONEX.Debug.IsTestLevel", 1);
*/
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LaughingLeader_WeaponExpansion"
