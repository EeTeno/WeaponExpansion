Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
//REGION RELOADING
IF
SkillCast(_Char, "Shout_LLWEAPONEX_HandCrossbow_Reload", _, _)
THEN
LLWEAPONEX_HandCrossbow_Reload(_Char);
ClearTag(_Char, "LLWEAPONEX_HandCrossbow_CanReload");

PROC
LLWEAPONEX_HandCrossbow_Reload((CHARACTERGUID)_Char)
AND
CharacterGetEquippedItem(_Char, "Ring", (ITEMGUID)_HandCrossbow)
AND
IsTagged(_HandCrossbow, "LLWEAPONEX_HandCrossbow", 1)
AND
ItemGetMaxCharges(_HandCrossbow, _Max)
THEN
ItemAddCharges(_HandCrossbow, _Max);

PROC
LLWEAPONEX_HandCrossbow_Reload((CHARACTERGUID)_Char)
AND
CharacterGetEquippedItem(_Char, "Ring2", (ITEMGUID)_HandCrossbow)
AND
IsTagged(_HandCrossbow, "LLWEAPONEX_HandCrossbow", 1)
AND
ItemGetMaxCharges(_HandCrossbow, _Max)
THEN
ItemAddCharges(_HandCrossbow, _Max);
//END_REGION

//REGION EQUIPPED
PROC
LLWEAPONEX_OnItemEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, "ARM_UNIQUE_LLWEAPONEX_HandCrossbow_A_Ring_ad15f666-285d-4634-a832-ea643fa0a9d2")
AND
CharacterIsPlayer(_Char, _a)
AND
CharacterIsPartyMember(_Char, _b)
AND
IntegerMax(_a, _b, _IsPlayer)
THEN
LLWEAPONEX_OnWeaponTypeEquipped(_Char, _Item, "LLWEAPONEX_HandCrossbow", _IsPlayer);

PROC
LLWEAPONEX_OnItemEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, "ARM_UNIQUE_LLWEAPONEX_HandCrossbow_A_Ring_ad15f666-285d-4634-a832-ea643fa0a9d2")
THEN
//LeaderLib_Tags_PreserveTag(_Char, "LLWEAPONEX_HandCrossbow_Equipped");
LLWEAPONEX_HandCrossbow_OnEquipped(_Char, _Item, "ARM_UNIQUE_LLWEAPONEX_HandCrossbow_A_Ring_ad15f666-285d-4634-a832-ea643fa0a9d2");

PROC
LLWEAPONEX_OnItemUnEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, "ARM_UNIQUE_LLWEAPONEX_HandCrossbow_A_Ring_ad15f666-285d-4634-a832-ea643fa0a9d2")
THEN
//LeaderLib_Tags_ClearPreservedTag(_Char, "LLWEAPONEX_HandCrossbow_Equipped");
LLWEAPONEX_HandCrossbow_OnUnEquipped(_Char, _Item, "ARM_UNIQUE_LLWEAPONEX_HandCrossbow_A_Ring_ad15f666-285d-4634-a832-ea643fa0a9d2");
//END_REGION

//REGION SKILL_TAGS_SET
QRY
LLWEAPONEX_HandCrossbow_QRY_GetHandcrossbow((CHARACTERGUID)_Char, (INTEGER)_AutoInsertCheck)
AND
CharacterGetEquippedItem(_Char, "Ring", (ITEMGUID)_HandCrossbow)
AND
IsTagged(_HandCrossbow, "LLWEAPONEX_HandCrossbow", 1)
AND
LeaderLib_Helper_QRY_ObjectFlagEquals(_HandCrossbow, "LLWEAPONEX_HandCrossbow_DisableAutoInsert", _AutoInsertCheck)
THEN
DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _HandCrossbow);

QRY
LLWEAPONEX_HandCrossbow_QRY_GetHandcrossbow((CHARACTERGUID)_Char, (INTEGER)_AutoInsertCheck)
AND
NOT DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _)
AND
CharacterGetEquippedItem(_Char, "Ring2", (ITEMGUID)_HandCrossbow)
AND
IsTagged(_HandCrossbow, "LLWEAPONEX_HandCrossbow", 1)
AND
LeaderLib_Helper_QRY_ObjectFlagEquals(_HandCrossbow, "LLWEAPONEX_HandCrossbow_DisableAutoInsert", _AutoInsertCheck)
THEN
DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _HandCrossbow);

QRY
LLWEAPONEX_HandCrossbow_QRY_GetHandcrossbow((CHARACTERGUID)_Char)
AND
CharacterGetEquippedItem(_Char, "Ring", (ITEMGUID)_HandCrossbow)
AND
IsTagged(_HandCrossbow, "LLWEAPONEX_HandCrossbow", 1)
THEN
DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _HandCrossbow);

QRY
LLWEAPONEX_HandCrossbow_QRY_GetHandcrossbow((CHARACTERGUID)_Char)
AND
NOT DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _)
AND
CharacterGetEquippedItem(_Char, "Ring2", (ITEMGUID)_HandCrossbow)
AND
IsTagged(_HandCrossbow, "LLWEAPONEX_HandCrossbow", 1)
THEN
DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _HandCrossbow);

PROC
LLWEAPONEX_HandCrossbow_OnEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, (STRING)_Template)
AND
ObjectGetFlag(_Item, "LLWEAPONEX_HandCrossbow_DisableAutoInsert", 0)
AND
NOT ItemGetRuneItemTemplate(_Item, 0, _)
AND
DB_LeaderLib_Helper_Runes_Templates("WeaponExpansion.HandCrossbowBolt", _RuneTemplate)
AND
NOT DB_LLWEAPONEX_Handcrossbow_Temp_AutoInsertedBolts(_Char, _Item)
AND
GetItemForItemTemplateInInventory(_Char, _RuneTemplate, _Bolts)
THEN
DB_LLWEAPONEX_Handcrossbow_Temp_AutoInsertedBolts(_Char, _Item);
ItemInsertRune(_Char, _Item, _RuneTemplate, 0);
ItemRemove(_Bolts);
LeaderLib_Tags_PreserveTag(_Char, "LLWEAPONEX_HandCrossbow_HasAmmo");
LeaderLib_Helper_RefreshUI(_Char);
LeaderLog_Log("DEBUG", "[LLWEAPONEX_14_HandCrossbow:OnEquipped] Auto-inserted crossbow bolts into empty Handcrossbow.");
CharacterStatusText(_Char, "LLWEAPONEX_StatusText_Handcrossbow_BoltAutoInserted");

PROC
LLWEAPONEX_HandCrossbow_OnEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, (STRING)_Template)
AND
CharacterHasSkill(_Char, "Shout_LLWEAPONEX_HandCrossbow_Reload", 0)
THEN
CharacterAddSkill(_Char, "Shout_LLWEAPONEX_HandCrossbow_Reload", 1);
LLWEAPONEX_HandCrossbow_TagForReload(_Char, _Item);

PROC
LLWEAPONEX_HandCrossbow_OnEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, (STRING)_Template)
AND
NOT DB_LLWEAPONEX_Handcrossbow_Temp_AutoInsertedBolts(_Char, _Item)
AND
ItemGetRuneItemTemplate(_Item, 0, _RuneTemplate)
AND
DB_LeaderLib_Helper_Runes_Templates("WeaponExpansion.HandCrossbowBolt", _RuneTemplate)
THEN
LeaderLib_Tags_PreserveTag(_Char, "LLWEAPONEX_HandCrossbow_HasAmmo");
LeaderLib_Helper_RefreshUI(_Char);
LeaderLog_Log("DEBUG", "[LLWEAPONEX_14_HandCrossbow:OnEquipped] Crossbow has ammo. ");

PROC
LLWEAPONEX_HandCrossbow_OnEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, (STRING)_Template)
AND
DB_LLWEAPONEX_Handcrossbow_Temp_AutoInsertedBolts(_Char, _Item)
THEN
NOT DB_LLWEAPONEX_Handcrossbow_Temp_AutoInsertedBolts(_Char, _Item);

IF
ObjectWasTagged((CHARACTERGUID)_Char, "LLWEAPONEX_HandCrossbow_HasAmmo")
THEN
LLWEAPONEX_HandCrossbow_TagForReload(_Char);

PROC
LLWEAPONEX_HandCrossbow_TagForReload((CHARACTERGUID)_Char)
AND
GetItemForItemTemplateInInventory(_Char, "ARM_UNIQUE_LLWEAPONEX_HandCrossbow_A_Ring_ad15f666-285d-4634-a832-ea643fa0a9d2", _HandCrossbow)
THEN
LLWEAPONEX_HandCrossbow_TagForReload(_Char, _HandCrossbow);

PROC
LLWEAPONEX_HandCrossbow_TagForReload((CHARACTERGUID)_Char, (ITEMGUID)_HandCrossbow)
AND
ItemGetCharges(_HandCrossbow, _Charges)
AND
ItemGetMaxCharges(_HandCrossbow, _MaxCharges)
AND
_Charges < _MaxCharges
THEN
LeaderLib_Tags_PreserveTag(_Char, "LLWEAPONEX_HandCrossbow_CanReload");
LeaderLib_Helper_RefreshUI(_Char);
LeaderLog_Log("DEBUG", "[LLWEAPONEX_14_HandCrossbow:OnEquipped] Crossbow can reload. ");
//END_REGION

//REGION SKILL_TAGS_CLEAR
PROC
LLWEAPONEX_HandCrossbow_OnUnEquipped((CHARACTERGUID)_Char, (ITEMGUID)_Item, (STRING)_Template)
THEN
LeaderLib_Tags_ClearPreservedTag(_Char, "LLWEAPONEX_HandCrossbow_CanReload");
LeaderLib_Tags_ClearPreservedTag(_Char, "LLWEAPONEX_HandCrossbow_HasAmmo");
CharacterRemoveSkill(_Char, "Shout_LLWEAPONEX_HandCrossbow_Reload");
//END_REGION

//REGION HANDCROSSBOW_HIT_DAMAGE
IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_DEFAULT", (CHARACTERGUID)_Cause)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_SCALED_DEFAULT", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_DEFAULT", (CHARACTERGUID)_Cause)
AND
LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_WEAPON_DEFAULT", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_AIR", (CHARACTERGUID)_Cause)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_SCALED_AIR", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_AIR", (CHARACTERGUID)_Cause)
AND
LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_WEAPON_AIR", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_CORROSIVE", (CHARACTERGUID)_Cause)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_SCALED_CORROSIVE", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_CORROSIVE", (CHARACTERGUID)_Cause)
AND
LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_WEAPON_CORROSIVE", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_EARTH", (CHARACTERGUID)_Cause)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_SCALED_EARTH", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_EARTH", (CHARACTERGUID)_Cause)
AND
LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_WEAPON_EARTH", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_FIRE", (CHARACTERGUID)_Cause)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_SCALED_FIRE", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_FIRE", (CHARACTERGUID)_Cause)
AND
LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_WEAPON_FIRE", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_POISON", (CHARACTERGUID)_Cause)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_SCALED_POISON", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_POISON", (CHARACTERGUID)_Cause)
AND
LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_WEAPON_POISON", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_SHADOW", (CHARACTERGUID)_Cause)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_SCALED_SHADOW", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_SHADOW", (CHARACTERGUID)_Cause)
AND
LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_WEAPON_SHADOW", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_WATER", (CHARACTERGUID)_Cause)
AND
NOT LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_SCALED_WATER", 0.0, 1, _Cause);

IF
CharacterStatusAttempt(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_HIT_WATER", (CHARACTERGUID)_Cause)
AND
LeaderLib_Helper_QRY_WeaponIsEquipped(_Cause)
THEN
ApplyStatus(_Target, "LLWEAPONEX_HANDCROSSBOW_SHOOT_DAMAGE_WEAPON_WATER", 0.0, 1, _Cause);
//END_REGION

//REGION AUTO_LOAD
PROC
LLWEAPONEX_HandCrossbow_TryInsertBolt((CHARACTERGUID)_Char, (ITEMGUID)_Bolt, (STRING)_Template, 0)
AND
LeaderLog_QRY_Log("DEBUG", "[LLWEAPONEX_14_HandCrossbow:TryInsertBolt] Trying to insert bolt (",_Template,")")
AND
IsTagged(_Char, "LLWEAPONEX_HandCrossbow_Enabled", 1)
AND
LeaderLog_QRY_Log("DEBUG", "[LLWEAPONEX_14_HandCrossbow:TryInsertBolt] Checking LLWEAPONEX_HandCrossbow_HasAmmo tag")
AND
IsTagged(_Char, "LLWEAPONEX_HandCrossbow_HasAmmo", 0)
AND
LeaderLog_QRY_Log("DEBUG", "[LLWEAPONEX_14_HandCrossbow:TryInsertBolt] Getting HandCrossbow, checking for LLWEAPONEX_HandCrossbow_DisableAutoInsert flag.")
AND
LLWEAPONEX_HandCrossbow_QRY_GetHandcrossbow(_Char, 0)
AND
DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _HandCrossbow)
AND
NOT ItemGetRuneItemTemplate(_HandCrossbow, 0, _)
AND
LeaderLib_Helper_QRY_InsertRuneInSlot(_Char, _HandCrossbow, _Template, 0)
THEN
ItemRemove(_Bolt);
LeaderLib_Tags_PreserveTag(_Char, "LLWEAPONEX_HandCrossbow_HasAmmo");
LeaderLib_Helper_RefreshUI(_Char);
LeaderLog_Log("DEBUG", "[LLWEAPONEX_14_HandCrossbow:TryInsertBolt] Auto-inserted crossbow bolts into empty Handcrossbow.");
CharacterStatusText(_Char, "LLWEAPONEX_StatusText_Handcrossbow_BoltAutoInserted");

PROC
LLWEAPONEX_HandCrossbow_TryInsertBolt((CHARACTERGUID)_Char, (ITEMGUID)_Bolt, (STRING)_Template, 1)
AND
LLWEAPONEX_HandCrossbow_QRY_GetHandcrossbow(_Char)
AND
DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _HandCrossbow)
AND
LeaderLib_Helper_QRY_RemoveRunes(_Char, _HandCrossbow, 0)
AND
LeaderLib_Helper_QRY_InsertRuneInSlot(_Char, _HandCrossbow, _Template, 0)
THEN
ItemRemove(_Bolt);
LeaderLib_Tags_PreserveTag(_Char, "LLWEAPONEX_HandCrossbow_HasAmmo");
LeaderLib_Helper_RefreshUI(_Char);
LeaderLog_Log("DEBUG", "[LLWEAPONEX_14_HandCrossbow:TryInsertBolt] Quick-inserted crossbow bolts into HandCrossbow.");
CharacterStatusText(_Char, "LLWEAPONEX_StatusText_Handcrossbow_BoltAutoInserted");

PROC
LLWEAPONEX_HandCrossbow_TryInsertBolt((CHARACTERGUID)_Char, (ITEMGUID)_Bolt, (STRING)_Template, 1)
AND
NOT DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _)
THEN
ShowNotification(_Char, "LLWEAPONEX_Notifications_HandCrossbow_InsertBolts_NotEquipped");

PROC
LLWEAPONEX_HandCrossbow_TryInsertBolt((CHARACTERGUID)_Char, (ITEMGUID)_Bolt, (STRING)_Template, (INTEGER)_AutoInsertFlagCheck)
AND
DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _HandCrossbow)
THEN
NOT DB_LLWEAPONEX_Handcrossbow_Temp_Equipped(_Char, _HandCrossbow);

PROC
LLWEAPONEX_HandCrossbow_OnBoltInserted((CHARACTERGUID)_Char, (ITEMGUID)_HandCrossbow, (STRING)_Template, (INTEGER)_Slot)
AND
IsTagged(_HandCrossbow, "LLWEAPONEX_HandCrossbow", 1)
THEN
LeaderLib_Tags_PreserveTag(_Char, "LLWEAPONEX_HandCrossbow_HasAmmo");
LeaderLib_Helper_RefreshUI(_Char);
//END_REGION

//REGION BOLT_PICKUP_AUTO_LOAD
//Auto-generated

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Air_72a7d3aa-02d7-4c9b-a565-d94c8a5664b0, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Air_72a7d3aa-02d7-4c9b-a565-d94c8a5664b0", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Air_72a7d3aa-02d7-4c9b-a565-d94c8a5664b0", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Air_72a7d3aa-02d7-4c9b-a565-d94c8a5664b0", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Air_72a7d3aa-02d7-4c9b-a565-d94c8a5664b0", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Air_72a7d3aa-02d7-4c9b-a565-d94c8a5664b0", _Slot);

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Corrosive_598b8cb5-7f76-4c50-a609-2a3cd0aa0415, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Corrosive_598b8cb5-7f76-4c50-a609-2a3cd0aa0415", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Corrosive_598b8cb5-7f76-4c50-a609-2a3cd0aa0415", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Corrosive_598b8cb5-7f76-4c50-a609-2a3cd0aa0415", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Corrosive_598b8cb5-7f76-4c50-a609-2a3cd0aa0415", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Corrosive_598b8cb5-7f76-4c50-a609-2a3cd0aa0415", _Slot);

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Earth_8a29169a-e73d-4878-9769-8b4555140fb0, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Earth_8a29169a-e73d-4878-9769-8b4555140fb0", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Earth_8a29169a-e73d-4878-9769-8b4555140fb0", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Earth_8a29169a-e73d-4878-9769-8b4555140fb0", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Earth_8a29169a-e73d-4878-9769-8b4555140fb0", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Earth_8a29169a-e73d-4878-9769-8b4555140fb0", _Slot);

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Fire_1fe1e11c-2e54-4104-b80a-b6fa0b4b8e99, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Fire_1fe1e11c-2e54-4104-b80a-b6fa0b4b8e99", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Fire_1fe1e11c-2e54-4104-b80a-b6fa0b4b8e99", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Fire_1fe1e11c-2e54-4104-b80a-b6fa0b4b8e99", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Fire_1fe1e11c-2e54-4104-b80a-b6fa0b4b8e99", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Fire_1fe1e11c-2e54-4104-b80a-b6fa0b4b8e99", _Slot);

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Normal_baf9826a-abe8-4bc8-8c56-b68b5611c223, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Normal_baf9826a-abe8-4bc8-8c56-b68b5611c223", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Normal_baf9826a-abe8-4bc8-8c56-b68b5611c223", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Normal_baf9826a-abe8-4bc8-8c56-b68b5611c223", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Normal_baf9826a-abe8-4bc8-8c56-b68b5611c223", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Normal_baf9826a-abe8-4bc8-8c56-b68b5611c223", _Slot);

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Poison_c3f61b7d-5183-4664-9773-0b630374b7c9, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Poison_c3f61b7d-5183-4664-9773-0b630374b7c9", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Poison_c3f61b7d-5183-4664-9773-0b630374b7c9", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Poison_c3f61b7d-5183-4664-9773-0b630374b7c9", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Poison_c3f61b7d-5183-4664-9773-0b630374b7c9", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Poison_c3f61b7d-5183-4664-9773-0b630374b7c9", _Slot);

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Shadow_7dcb9e1f-b807-4321-8408-c66f833ae73c, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Shadow_7dcb9e1f-b807-4321-8408-c66f833ae73c", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Shadow_7dcb9e1f-b807-4321-8408-c66f833ae73c", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Shadow_7dcb9e1f-b807-4321-8408-c66f833ae73c", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Shadow_7dcb9e1f-b807-4321-8408-c66f833ae73c", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Shadow_7dcb9e1f-b807-4321-8408-c66f833ae73c", _Slot);

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Water_40af98d5-3584-40cc-8c9f-e3a49564f365, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Water_40af98d5-3584-40cc-8c9f-e3a49564f365", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Water_40af98d5-3584-40cc-8c9f-e3a49564f365", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Water_40af98d5-3584-40cc-8c9f-e3a49564f365", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Water_40af98d5-3584-40cc-8c9f-e3a49564f365", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_Water_40af98d5-3584-40cc-8c9f-e3a49564f365", _Slot);

IF
ItemTemplateAddedToCharacter(LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_WeaponProxy_8c1da19c-02e9-4a6c-b253-1b3e31b7740f, _Item, _Char)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_WeaponProxy_8c1da19c-02e9-4a6c-b253-1b3e31b7740f", 0);

IF
CharacterUsedItemTemplate(_Char, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_WeaponProxy_8c1da19c-02e9-4a6c-b253-1b3e31b7740f", _Item)
THEN
LLWEAPONEX_HandCrossbow_TryInsertBolt(_Char, _Item, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_WeaponProxy_8c1da19c-02e9-4a6c-b253-1b3e31b7740f", 1);

IF
RuneInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_WeaponProxy_8c1da19c-02e9-4a6c-b253-1b3e31b7740f", _Slot)
THEN
LLWEAPONEX_HandCrossbow_OnBoltInserted(_Char, _HandCrossbow, "LOOT_Rune_LLWEAPONEX_Crossbow_Bolt_WeaponProxy_8c1da19c-02e9-4a6c-b253-1b3e31b7740f", _Slot);
//END_REGION

EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LLWEAPONEX_00_PostCC"