Version 1
SubGoalCombiner SGC_AND
INITSECTION
LLWEAPONEX_ModCompatibility_InitSettings();
KBSECTION
//REGION EQUIPMENT_SETS
PROC
LLWEAPONEX_ModCompatibility_InitSettings()
THEN
//Bartering Tweaks
//DB_LLBARTER_DialogBlacklist("WeaponExpansion", "LLWEAPONEX_VendingMachine_A");
DB_LLBARTER_DialogBlacklist("WeaponExpansion", "LLWEAPONEX_VendingMachine_OrderMenu");
//DB_LLBARTER_DialogBlacklist("WeaponExpansion", "LLWEAPONEX_WeaponMaster");
LLWEAPONEX_ModCompatibility_InitMimicrySettings();

PROC
LLWEAPONEX_ModCompatibility_InitMimicrySettings()
AND
NOT DB_LLMIME_Mimicking_Blacklist_SkillPrefixes("WeaponExpansion", "Shout_LLWEAPONEX_Grimoire_Toggle_")
THEN
//Mimicry Skill Blacklist
DB_LLMIME_Mimicking_Blacklist_SkillPrefixes("WeaponExpansion","Shout_LLWEAPONEX_Grimoire_Toggle_");
//Rune statuses are auto-removed when a runeblade is unequipped, so mimicking these is pointless
DB_LLMIME_Mimicking_Blacklist_SkillPrefixes("WeaponExpansion","Shout_LLWEAPONEX_ActivateRuneblade_");
DB_LLMIME_Mimicking_Blacklist_SkillPrefixes("WeaponExpansion","LLWEAPONEX_ScriptStart_");

PROC
LLWEAPONEX_ModCompatibility_InitMimicrySettings()
THEN
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_ShieldToss_Returned");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_ThrowWeapon");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_Throw_Rock_Kevin_Effect");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_Throw_UniqueAxe_A");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_Throw_UniqueAxe_A_Offhand");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_Throw_UniqueAxe_A_Targeting");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Shout_LLWEAPONEX_Grimoire_DeathAura");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Shout_LLWEAPONEX_HandCrossbow_Reload");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Shout_LLWEAPONEX_Prepare_BalrinsAxe");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Shout_LLWEAPONEX_Rapier_DuelistStance");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Shout_LLWEAPONEX_RemoteMine_Add");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Target_LLWEAPONEX_CopyLastSkill");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Target_LLWEAPONEX_RemoteMine_Detonate");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Target_LLWEAPONEX_Torment_ClaimSoul");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Shout_LLWEAPONEX_RemoteMine_Breach_Knockback");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_RemoteMine_Throw_Base");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_RemoteMine_Throw_Breach");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_RemoteMine_Throw_Displacement");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_RemoteMine_Throw_Explosive");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_RemoteMine_Throw_PoisonGas");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_RemoteMine_Throw_Shrapnel");
DB_LLMIME_Mimicking_Blacklist_Skills("WeaponExpansion", "Projectile_LLWEAPONEX_RemoteMine_Throw_Tar");

PROC
LLWEAPONEX_ModCompatibility_Internal_CompileErrorFix_VSCode()
THEN
DB_LLMIME_Mimicking_Blacklist_SkillElements("Shout", "");

PROC
LLWEAPONEX_ModCompatibility_Internal_CompileErrorFix_VSCode()
AND
DB_Mimicry_BlockWeaponMimicking(NULL_00000000-0000-0000-0000-000000000000)
THEN
NOT DB_Mimicry_BlockWeaponMimicking(NULL_00000000-0000-0000-0000-000000000000);
//END_REGION

//REGION UPDATING
PROC
LeaderUpdater_ModUpdated("WeaponExpansion", "LaughingLeader", (STRING)_PastVersion, (STRING)_NewVersion)
AND
LeaderLib_StringExt_QRY_VersionIsLessThan(_PastVersion, 0,9,4,11)
THEN
LeaderLog_Log("DEBUG", "[LLWEAPONEX:ModCompatibility] Updating settings from version [",_PastVersion,"] to [",_NewVersion,"]");
LLWEAPONEX_ModCompatibility_InitMimicrySettings();
//END_REGION

//REGION MIMICRY_MIMICKED_WEAPONS
PROC
Mimicry_BlockMimickedWeapon((ITEMGUID)_Item)
AND
IsTagged(_Item, "LLWEAPONEX_Grimoire", 1)
THEN
DB_Mimicry_BlockWeaponMimicking(_Item);
//END_REGION

//REGION MIMICRY_MIMICKING_SKILLS
PROC
Mimicry_SetBasicAttackMimickingSkill((CHARACTERGUID)_Mime, (CHARACTERGUID)_Caster, (GUIDSTRING)_Target, (STRING)_Action)
AND
NOT DB_Mimicry_Mimicking_UseModAttackSkill(_Mime, _Caster, _Target, _Action, _)
AND
LeaderLib_Helper_QRY_HasTaggedWeapon(_Mime, "LLWEAPONEX_Greatbow")
THEN
DB_Mimicry_Mimicking_UseModAttackSkill(_Mime, _Caster, _Target, _Action, "Projectile_LLWEAPONEX_MimicGreatBowAttack");

PROC
Mimicry_SetBasicAttackMimickingSkill((CHARACTERGUID)_Mime, (CHARACTERGUID)_Caster, (GUIDSTRING)_Target, (STRING)_Action)
AND
NOT DB_Mimicry_Mimicking_UseModAttackSkill(_Mime, _Caster, _Target, _Action, _)
AND
LeaderLib_Helper_QRY_HasTaggedWeapon(_Mime, "LLWEAPONEX_Blunderbuss")
THEN
DB_Mimicry_Mimicking_UseModAttackSkill(_Mime, _Caster, _Target, _Action, "Projectile_LLWEAPONEX_MimicBlunderbussAttack");
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LaughingLeader_WeaponExpansion"