Version 1
SubGoalCombiner SGC_AND
INITSECTION

DB_Dialogs(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "LeaderLib_Debug_RecruitCharacter");
DB_Dialogs(S_Player_LLWEAPONEX_Korvash_3f20ae14-5339-4913-98f1-24476861ebd6, "LeaderLib_Debug_RecruitCharacter");

KBSECTION
IF
StoryEvent(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "LeaderLib_StoryEvents_Initialize")
AND
CharacterGetItemTemplateCount(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "WPN_UNIQUE_LLWEAPONEX_Anvil_Mace_2H_A_85e2e75e-4333-425e-adc4-94474c3fc201", 0)
AND
GetPosition(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, _x, _y, _z)
AND
CreateItemTemplateAtPosition("WPN_UNIQUE_LLWEAPONEX_Anvil_Mace_2H_A_85e2e75e-4333-425e-adc4-94474c3fc201", _x, _y, _z, _Hammer)
THEN
LeaderLog_Log("DEBUG", "[LLWEAPONEX_23_Companions:LeaderLib_StoryEvents_Initialize] Spawning and equipping the anvil mace to Harken.");
CharacterEquipItem(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, _Hammer);

IF
StoryEvent(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "LeaderLib_StoryEvents_Initialize")
AND
GetItemForItemTemplateInInventory(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "WPN_UNIQUE_LLWEAPONEX_Anvil_Mace_2H_A_85e2e75e-4333-425e-adc4-94474c3fc201", _Hammer)
AND
NOT CharacterGetEquippedWeapon(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, _Hammer)
THEN
CharacterEquipItem(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, _Hammer);
LeaderLog_Log("DEBUG", "[LLWEAPONEX_23_Companions:Initialize] Equipped Harken with the anvil hammer.");

IF
CharacterStatusApplied(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "UNSHEATHED", _)
THEN
ApplyStatus(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "LLWEAPONEX_TATTOOS_MAGIC_UPPERBODY_A", -1.0, 0, S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b);

IF
CharacterStatusRemoved(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "UNSHEATHED", _)
THEN
RemoveStatus(S_Player_LLWEAPONEX_Harken_e446752a-13cc-4a88-a32e-5df244c90d8b, "LLWEAPONEX_TATTOOS_MAGIC_UPPERBODY_A");

IF
StoryEvent(_Char, "LeaderLib_StoryEvents_OnInit")
AND
String(_Char, _Str)
THEN
LeaderLog_Log("DEBUG", "[LLWEAPONEX_23_Companions:LeaderLib_StoryEvents_OnInit] (",_Str,") OnInit was called.");

IF
StoryEvent(_Char, "LeaderLib_StoryEvents_Initialize")
AND
String(_Char, _Str)
THEN
LeaderLog_Log("DEBUG", "[LLWEAPONEX_23_Companions:LeaderLib_StoryEvents_Initialize] (",_Str,") initialized");

IF
StoryEvent(_Char, "LeaderLib_StoryEvents_OnActivate")
AND
String(_Char, _Str)
THEN
LeaderLog_Log("DEBUG", "[LLWEAPONEX_23_Companions:LeaderLib_StoryEvents_OnActivate] (",_Str,") was activated");

IF
StoryEvent(_Char, "LeaderLib_StoryEvents_OnDeactivate")
AND
String(_Char, _Str)
THEN
LeaderLog_Log("DEBUG", "[LLWEAPONEX_23_Companions:LeaderLib_StoryEvents_OnDeactivate] (",_Str,") was deactivated");

IF
StoryEvent(_Char, "LeaderLib_StoryEvents_OnShutdown")
AND
String(_Char, _Str)
THEN
LeaderLog_Log("DEBUG", "[LLWEAPONEX_23_Companions:LeaderLib_StoryEvents_OnShutdown] (",_Str,") was shutdown.");

PROC
ProcOriginReturnToRecruitmentPos((CHARACTERGUID)_Origin)
AND
NOT DB_OriginRecruitmentLocation_Region(_,_Origin,_,_)
THEN
SetStoryEvent(_Origin,"Origin_RestoreDialog");

EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LaughingLeader_WeaponExpansion"